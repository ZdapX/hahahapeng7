<script>
    const socket = io();
    const audio = document.getElementById('horrorAudio');
    const statusDiv = document.getElementById('status');
    const deviceName = "HP_Target_" + Math.floor(Math.random() * 999);

    // LANGSUNG DAFTAR SAAT KONEK (Tanpa nunggu klik)
    socket.emit('register-output', deviceName);

    window.onclick = () => {
        // Hanya untuk mengaktifkan izin audio browser
        audio.play().then(() => {
            audio.pause();
            statusDiv.innerText = "Sinyal Aktif & Siap Menerima Perintah";
            statusDiv.className = "text-green-500 font-bold";
        }).catch(e => console.log("Audio belum aktif"));
    };

    socket.on('audio-control', (action) => {
        if (action === 'play') {
            audio.currentTime = 0; // Mulai dari awal
            audio.play();
            statusDiv.innerText = "⚠️ SUARA SEDANG BERMAIN ⚠️";
        } else {
            audio.pause();
            statusDiv.innerText = "Suara Berhenti";
        }
    });
</script>
